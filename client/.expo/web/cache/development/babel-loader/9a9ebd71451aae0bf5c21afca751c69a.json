{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { REMOVE_TOKEN, SET_TOKEN, SET_USER_INFO, REMOVE_USER_INFO, CHANGE_STATUS_LIKE, CHANGE_STATUS_COMMENT, CHANGE_STATUS_OLD, GET_SUBSCRIBE_START } from \"../types/userTypes\";\nimport * as endPoints from \"../../config/endPoints\";\nimport { disableLoader, enableLoader } from \"./loader.ac\";\nimport { signUp as apiSignUp, signIn as apiSignIn, signOut as apiSignOut } from \"../../api/auth\";\nimport apiService from \"../../api/apiService\";\n\nvar getSubscribeStart = function getSubscribeStart(payload) {\n  return {\n    type: GET_SUBSCRIBE_START,\n    payload: payload\n  };\n};\n\nexport var goToSubscribe = function goToSubscribe(description) {\n  return function _callee(dispatch) {\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            apiService.post(\"/api/v2/users/subscribe\", description);\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var goToDisSubscribe = function goToDisSubscribe(description) {\n  return function _callee2(dispatch) {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            apiService.post(\"/api/v2/users/subdisscribe\", description);\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var getUserFromServer = function getUserFromServer(id) {\n  return function _callee3(dispatch) {\n    var response, currentUser;\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            dispatch(enableLoader());\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(fetch(endPoints.getUser(id), {\n              credentials: \"include\"\n            }));\n\n          case 3:\n            response = _context3.sent;\n\n            if (!(response.status === 200)) {\n              _context3.next = 8;\n              break;\n            }\n\n            _context3.next = 7;\n            return _regeneratorRuntime.awrap(response.json());\n\n          case 7:\n            currentUser = _context3.sent;\n\n          case 8:\n            dispatch(disableLoader());\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var chageStatusLike = function chageStatusLike(payload) {\n  return {\n    type: CHANGE_STATUS_LIKE,\n    payload: payload\n  };\n};\nexport var chageStatusComment = function chageStatusComment(payload) {\n  return {\n    type: CHANGE_STATUS_COMMENT,\n    payload: payload\n  };\n};\nexport var chageStatusOld = function chageStatusOld(payload) {\n  return {\n    type: CHANGE_STATUS_OLD,\n    payload: payload\n  };\n};\nexport var setToken = function setToken(accessToken, refreshToken) {\n  return {\n    type: SET_TOKEN,\n    payload: {\n      accessToken: accessToken,\n      refreshToken: refreshToken\n    }\n  };\n};\nexport var removeToken = function removeToken() {\n  return {\n    type: REMOVE_TOKEN\n  };\n};\nexport var setUserInfo = function setUserInfo(userInfo) {\n  return {\n    type: SET_USER_INFO,\n    payload: {\n      userInfo: userInfo\n    }\n  };\n};\nexport var removeUserInfo = function removeUserInfo() {\n  return {\n    type: REMOVE_USER_INFO\n  };\n};\nexport var signUp = function signUp(signUpInfo) {\n  return function _callee4(dispatch) {\n    var _await$apiSignUp, data, _data$auth, accessToken, refreshToken, userInfo;\n\n    return _regeneratorRuntime.async(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            dispatch(enableLoader());\n            _context4.prev = 1;\n            _context4.next = 4;\n            return _regeneratorRuntime.awrap(apiSignUp(signUpInfo));\n\n          case 4:\n            _await$apiSignUp = _context4.sent;\n            data = _await$apiSignUp.data;\n            _data$auth = data.auth, accessToken = _data$auth.accessToken, refreshToken = _data$auth.refreshToken, userInfo = data.userInfo;\n            dispatch(setToken(accessToken, refreshToken));\n            dispatch(setUserInfo(userInfo));\n            _context4.next = 14;\n            break;\n\n          case 11:\n            _context4.prev = 11;\n            _context4.t0 = _context4[\"catch\"](1);\n            console.log(_context4.t0);\n\n          case 14:\n            dispatch(disableLoader());\n\n          case 15:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[1, 11]], Promise);\n  };\n};\nexport var signIn = function signIn(loginInfo) {\n  return function _callee5(dispatch) {\n    var _await$apiSignIn, data, _data$auth2, accessToken, refreshToken, userInfo;\n\n    return _regeneratorRuntime.async(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            dispatch(enableLoader());\n            _context5.prev = 1;\n            _context5.next = 4;\n            return _regeneratorRuntime.awrap(apiSignIn(loginInfo));\n\n          case 4:\n            _await$apiSignIn = _context5.sent;\n            data = _await$apiSignIn.data;\n            _data$auth2 = data.auth, accessToken = _data$auth2.accessToken, refreshToken = _data$auth2.refreshToken, userInfo = data.userInfo;\n            dispatch(setToken(accessToken, refreshToken));\n            dispatch(setUserInfo(userInfo));\n            _context5.next = 14;\n            break;\n\n          case 11:\n            _context5.prev = 11;\n            _context5.t0 = _context5[\"catch\"](1);\n            console.log(_context5.t0);\n\n          case 14:\n            dispatch(disableLoader());\n\n          case 15:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, [[1, 11]], Promise);\n  };\n};\nexport var signOut = function signOut() {\n  return function _callee6(dispatch, getState) {\n    var refreshToken, response;\n    return _regeneratorRuntime.async(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            dispatch(enableLoader());\n            _context6.prev = 1;\n            refreshToken = getState().user.jwt.refresh;\n            _context6.next = 5;\n            return _regeneratorRuntime.awrap(apiSignOut(refreshToken));\n\n          case 5:\n            response = _context6.sent;\n\n            if (response.status === 200) {\n              dispatch(removeToken());\n              dispatch(removeUserInfo());\n            }\n\n            _context6.next = 12;\n            break;\n\n          case 9:\n            _context6.prev = 9;\n            _context6.t0 = _context6[\"catch\"](1);\n            console.log(_context6.t0);\n\n          case 12:\n            dispatch(disableLoader());\n\n          case 13:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, [[1, 9]], Promise);\n  };\n};\nexport var checkAuth = function checkAuth() {\n  return function _callee7(dispatch) {\n    return _regeneratorRuntime.async(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\nexport var editUser = function editUser(user, history) {\n  return function _callee8(dispatch, getState) {\n    return _regeneratorRuntime.async(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};","map":{"version":3,"sources":["/home/artur/elbrus/phase-3/ПРОЕКТВЕКА/copy 2/RedditNativeChallenge/client/src/redux/actions/user.ac.js"],"names":["REMOVE_TOKEN","SET_TOKEN","SET_USER_INFO","REMOVE_USER_INFO","CHANGE_STATUS_LIKE","CHANGE_STATUS_COMMENT","CHANGE_STATUS_OLD","GET_SUBSCRIBE_START","endPoints","disableLoader","enableLoader","signUp","apiSignUp","signIn","apiSignIn","signOut","apiSignOut","apiService","getSubscribeStart","payload","type","goToSubscribe","description","dispatch","post","goToDisSubscribe","getUserFromServer","id","fetch","getUser","credentials","response","status","json","currentUser","chageStatusLike","chageStatusComment","chageStatusOld","setToken","accessToken","refreshToken","removeToken","setUserInfo","userInfo","removeUserInfo","signUpInfo","data","auth","console","log","loginInfo","getState","user","jwt","refresh","checkAuth","editUser","history"],"mappings":"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","sourcesContent":["import {\n  REMOVE_TOKEN,\n  SET_TOKEN,\n  SET_USER_INFO,\n  REMOVE_USER_INFO,\n  CHANGE_STATUS_LIKE,\n  CHANGE_STATUS_COMMENT,\n  CHANGE_STATUS_OLD,\n  GET_SUBSCRIBE_START,\n} from \"../types/userTypes\";\nimport * as endPoints from \"../../config/endPoints\";\nimport { disableLoader, enableLoader } from \"./loader.ac\";\nimport {\n  signUp as apiSignUp,\n  signIn as apiSignIn,\n  signOut as apiSignOut,\n} from \"../../api/auth\";\nimport apiService from \"../../api/apiService\";\nconst getSubscribeStart = payload => ({ type: GET_SUBSCRIBE_START, payload });\nexport const goToSubscribe = description => async dispatch => {\n  apiService.post(\"/api/v2/users/subscribe\", description);\n  // .then(({ data }) => dispatch(getSubscribeStart(description)));\n};\n\nexport const goToDisSubscribe = description => async dispatch => {\n  apiService.post(\"/api/v2/users/subdisscribe\", description);\n  // .then(({ data }) => dispatch(getSubscribeStart(description)));\n};\nexport const getUserFromServer = id => async dispatch => {\n  dispatch(enableLoader());\n  const response = await fetch(endPoints.getUser(id), {\n    credentials: \"include\",\n  });\n  if (response.status === 200) {\n    const currentUser = await response.json();\n    // dispatch(setUser(currentUser));\n  }\n  dispatch(disableLoader());\n};\nexport const chageStatusLike = payload => ({\n  type: CHANGE_STATUS_LIKE,\n  payload,\n});\nexport const chageStatusComment = payload => ({\n  type: CHANGE_STATUS_COMMENT,\n  payload,\n});\nexport const chageStatusOld = payload => ({\n  type: CHANGE_STATUS_OLD,\n  payload,\n});\nexport const setToken = (accessToken, refreshToken) => ({\n  type: SET_TOKEN,\n  payload: { accessToken, refreshToken },\n});\n\nexport const removeToken = () => ({\n  type: REMOVE_TOKEN,\n});\n\nexport const setUserInfo = userInfo => ({\n  type: SET_USER_INFO,\n  payload: { userInfo },\n});\n\nexport const removeUserInfo = () => ({\n  type: REMOVE_USER_INFO,\n});\n\nexport const signUp = signUpInfo => async dispatch => {\n  dispatch(enableLoader());\n\n  try {\n    const { data } = await apiSignUp(signUpInfo);\n    const {\n      auth: { accessToken, refreshToken },\n      userInfo,\n    } = data;\n    dispatch(setToken(accessToken, refreshToken));\n    dispatch(setUserInfo(userInfo));\n  } catch (error) {\n    console.log(error);\n  }\n\n  dispatch(disableLoader());\n};\n\nexport const signIn = loginInfo => async dispatch => {\n  dispatch(enableLoader());\n  try {\n    const { data } = await apiSignIn(loginInfo);\n    const {\n      auth: { accessToken, refreshToken },\n      userInfo,\n    } = data;\n    dispatch(setToken(accessToken, refreshToken));\n    dispatch(setUserInfo(userInfo));\n  } catch (error) {\n    console.log(error);\n  }\n\n  dispatch(disableLoader());\n};\n\nexport const signOut = () => async (dispatch, getState) => {\n  dispatch(enableLoader());\n  try {\n    const refreshToken = getState().user.jwt.refresh;\n    const response = await apiSignOut(refreshToken);\n    if (response.status === 200) {\n      dispatch(removeToken());\n      dispatch(removeUserInfo());\n    }\n  } catch (error) {\n    console.log(error);\n  }\n\n  dispatch(disableLoader());\n};\n\nexport const checkAuth = () => async dispatch => {\n  //   const response = await fetch(endPoints.checkAuth(), {\n  //     // credentials: \"include\",\n  //   });\n  //   if (response.status === 200) {\n  //     const user = await response.json();\n  //     dispatch(setUser(user));\n  //   }\n};\n\nexport const editUser = (user, history) => async (dispatch, getState) => {\n  // const {\n  //   user: { _id: userId },\n  // } = getState();\n  // dispatch(enableLoader());\n  // const response = await fetch(endPoints.editUser(userId), {\n  //   method: \"PATCH\",\n  //   headers: {\n  //     \"Content-Type\": \"application/json\",\n  //   },\n  //   // credentials: \"include\",\n  //   body: JSON.stringify(user),\n  // });\n  // if (response.status === 200) {\n  //   const user = await response.json();\n  //   dispatch(setUser(user));\n  //   history.replace(`/users/${user._id}`);\n  // } else {\n  //   history.replace(\"/\");\n  // }\n  // dispatch(disableLoader());\n};\n"]},"metadata":{},"sourceType":"module"}